




<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"
><head>
  <meta charset="utf-8" />
  
    <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="rgb(255,255,255)" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>查询、插入、删除、更新一条MySQL记录都经历了什么 &middot; 主页</title>
    <meta name="title" content="查询、插入、删除、更新一条MySQL记录都经历了什么 &middot; 主页" />
  
  <meta name="description" content="" />
  
  
  
  <link rel="canonical" href="/internet/MySQL/curd/" />
  
  
  
  
  
  
  
  
  
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.d2d22c5c1c2460999b194d3fbbce6097c00f40fb952d56864bb609de68cbc5ea.css"
    integrity="sha256-0tIsXBwkYJmbGU0/u85gl8APQPuVLVaGS7YJ3mjLxeo="
  />
  
  
  <script type="text/javascript" src="/js/appearance.min.022d0ebc3b46a335eb1c7ef79b7f2de143d7cd5156d433638592ef1ce5f8554e.js" integrity="sha256-Ai0OvDtGozXrHH73m38t4UPXzVFW1DNjhZLvHOX4VU4="></script>
  
    
    
    
  
  
    
    
  
  
  
    
    <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.75206d23ef83f4908b2bdd2317bf6ddff399e9173a16fff5451c40b8e857cfa8.js" integrity="sha256-dSBtI&#43;&#43;D9JCLK90jF79t3/OZ6Rc6Fv/1RRxAuOhXz6g=" data-copy="Copy" data-copied="Copied"></script>
  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="查询、插入、删除、更新一条MySQL记录都经历了什么" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/internet/MySQL/curd/" /><meta property="article:section" content="internet" />
<meta property="article:published_time" content="2022-01-06T17:05:00+08:00" />
<meta property="article:modified_time" content="2022-01-06T17:05:00+08:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="查询、插入、删除、更新一条MySQL记录都经历了什么"/>
<meta name="twitter:description" content=""/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "",
    "name": "查询、插入、删除、更新一条MySQL记录都经历了什么",
    "headline": "查询、插入、删除、更新一条MySQL记录都经历了什么",
    
    
    "inLanguage": "en",
    "url" : "\/internet\/MySQL\/curd\/",
    "author" : {
      "@type": "Person",
      "name": "stong"
    },
    "copyrightYear": "2022",
    "dateCreated": "2022-01-06T17:05:00\u002b08:00",
    "datePublished": "2022-01-06T17:05:00\u002b08:00",
    
    "dateModified": "2022-01-06T17:05:00\u002b08:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "3795"
  }]
  </script>


  
  <meta name="author" content="stong" />
  
    
      <link href="st5983@outlook.com" rel="me" />
    
      <link href="https://stong1994.github.io/" rel="me" />
    
      <link href="https://github.com/stong1994" rel="me" />
    
  
  
  






  
  
  
  


  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content"
        ><span class="font-bold pe-2 text-primary-600 dark:text-primary-400">&darr;</span
        >Skip to main content</a
      >
    </div>
    
    
      <header class="py-6 font-semibold text-neutral-900 dark:text-neutral print:hidden sm:py-10">
  <nav class="flex items-start justify-between sm:items-center">
    
    <div class="z-40 flex flex-row items-center">
      
  <a
    class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
    rel="me"
    href="/"
    >主页</a
  >

      

    </div>
    
      
      <label id="menu-button" for="menu-controller" class="block sm:hidden">
        <input type="checkbox" id="menu-controller" class="hidden" />
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


        </div>
        <div
          id="menu-wrapper"
          class="invisible fixed inset-0 z-30 m-auto h-full w-full cursor-default overflow-auto bg-neutral-100/50 opacity-0 backdrop-blur-sm transition-opacity dark:bg-neutral-900/50"
        >
          <ul
            class="mx-auto flex w-full max-w-7xl list-none flex-col overflow-visible px-6 py-6 ltr:text-right rtl:text-left sm:px-14 sm:py-10 sm:pt-10 md:px-24 lg:px-32"
          >
            <li class="mb-1">
              <span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"
                >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span
              >
            </li>
            
              
                <li class="group mb-1">
                  
                    <a
                      href="/internet/"
                      title=""
                      
                      >
                        <span
                          class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                          >计算机与互联网</span
                        >
                      </a
                    >
                  
                </li>
              
                <li class="group mb-1">
                  
                    <a
                      href="/cloudnative/"
                      title=""
                      
                      >
                        <span
                          class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                          >云原生</span
                        >
                      </a
                    >
                  
                </li>
              
                <li class="group mb-1">
                  
                    <a
                      href="/web3/"
                      title="Web3s"
                      
                      >
                        <span
                          class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                          >区块链&amp;web3</span
                        >
                      </a
                    >
                  
                </li>
              
                <li class="group mb-1">
                  
                    <a
                      href="/book/"
                      title=""
                      
                      >
                        <span
                          class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                          >读书笔记</span
                        >
                      </a
                    >
                  
                </li>
              
                <li class="group mb-1">
                  
                    <a
                      href="/other/"
                      title=""
                      
                      >
                        <span
                          class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                          >杂谈</span
                        >
                      </a
                    >
                  
                </li>
              
                <li class="group mb-1">
                  
                    <a
                      href="/mental_model/"
                      title=""
                      
                      >
                        <span
                          class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                          >心智模型</span
                        >
                      </a
                    >
                  
                </li>
              
                <li class="group mb-1">
                  
                    <a
                      href="/about/"
                      title=""
                      
                      >
                        <span
                          class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                          >关于</span
                        >
                      </a
                    >
                  
                </li>
              
                <li class="group mb-1">
                  
                    <a
                      href="https://github.com/stong1994/"
                      title=""
                      target="_blank"
                      >
                        <span
                          class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"
                        >
                          

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                        </span>
                      </a
                    >
                  
                </li>
              
                <li class="group mb-1">
                  
                    
                    
                      <button
                        id="search-button-1"
                        title="Search (/)"
                      >
                        
                          <span
                            class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"
                          >
                            

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


                          </span>
                        
                          <span
                            class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                            ></span
                          >
                        
                      </button>
                    
                  
                </li>
              
              
            
          </ul>
        </div>
      </label>
      
      <ul class="hidden list-none flex-row ltr:text-right rtl:text-left sm:flex">
        
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0">
              
                <a
                  href="/internet/"
                  title=""
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >计算机与互联网</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0">
              
                <a
                  href="/cloudnative/"
                  title=""
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >云原生</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0">
              
                <a
                  href="/web3/"
                  title="Web3s"
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >区块链&amp;web3</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0">
              
                <a
                  href="/book/"
                  title=""
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >读书笔记</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0">
              
                <a
                  href="/other/"
                  title=""
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >杂谈</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0">
              
                <a
                  href="/mental_model/"
                  title=""
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >心智模型</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0">
              
                <a
                  href="/about/"
                  title=""
                  
                  >
                    <span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >关于</span
                    >
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0">
              
                <a
                  href="https://github.com/stong1994/"
                  title=""
                  target="_blank"
                  >
                    <span
                      class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"
                    >
                      

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


                    </span>
                  </a
                >
              
            </li>
          
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0">
              
                
                
                  <button
                    id="search-button-2"
                    title="Search (/)"
                  >
                    
                      <span
                        class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"
                      >
                        

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


                      </span>
                    
                      <span
                        class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                        ></span
                      >
                    
                  </button>
                
              
            </li>
          
          

        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
        <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >记录个人的成长记录</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/internet/"
      >internet</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/internet/MySQL/curd/"
      >查询、插入、删除、更新一条MySQL记录都经历了什么</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        查询、插入、删除、更新一条MySQL记录都经历了什么
      </h1>
      <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
    
  

  

  
    
  

  
    
  

  
    
  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2022-01-06 17:05:00 &#43;0800 CST">6 January 2022</time><span class="px-2 text-primary-500">&middot;</span><span>3795 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">8 mins</span><span class="px-2 text-primary-500">&middot;</span>


  
  

<span class="mb-[2px]">
  <a
    href="https://github.com/stong1994/cristo/content/internet/storage/%e6%9f%a5%e8%af%a2%e3%80%81%e6%8f%92%e5%85%a5%e3%80%81%e5%88%a0%e9%99%a4%e3%80%81%e6%9b%b4%e6%96%b0%e4%b8%80%e6%9d%a1MySQL%e8%ae%b0%e5%bd%95%e9%83%bd%e7%bb%8f%e5%8e%86%e4%ba%86%e4%bb%80%e4%b9%88.md"
    class="text-lg hover:text-primary-500"
    rel="noopener noreferrer"
    target="_blank"
    title="Edit content"
    >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M490.3 40.4C512.2 62.27 512.2 97.73 490.3 119.6L460.3 149.7L362.3 51.72L392.4 21.66C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7L339.7 74.34L437.7 172.3L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2L159.6 382.8C150.1 385.6 141.5 383.4 135 376.1C128.6 370.5 126.4 361 129.2 352.4L158.8 263.6C161.6 255.3 166.2 247.8 172.4 241.7V241.7zM192 63.1C209.7 63.1 224 78.33 224 95.1C224 113.7 209.7 127.1 192 127.1H96C78.33 127.1 64 142.3 64 159.1V416C64 433.7 78.33 448 96 448H352C369.7 448 384 433.7 384 416V319.1C384 302.3 398.3 287.1 416 287.1C433.7 287.1 448 302.3 448 319.1V416C448 469 405 512 352 512H96C42.98 512 0 469 0 416V159.1C0 106.1 42.98 63.1 96 63.1H192z"/></svg>

  </span>

</a
  >
</span>
    

    
    
  </div>

  
  
    <div class="my-1 text-xs leading-relaxed text-neutral-500 dark:text-neutral-400 ">
      
        
      
        
      
    </div>
  


      </div>
      
    </header>
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
        <div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8">
          <div class="toc pe-5 print:hidden lg:sticky lg:top-10">
            <details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5">
  <summary
    class="-ms-5 block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div class="-ms-5 border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#mysql体系架构">MySQL体系架构</a></li>
    <li><a href="#建立连接">建立连接</a></li>
    <li><a href="#查询缓存">查询缓存</a></li>
    <li><a href="#解析sql">解析sql</a></li>
    <li><a href="#查询优化">查询优化</a></li>
    <li><a href="#执行语句">执行语句</a>
      <ul>
        <li><a href="#读取记录的过程">读取记录的过程</a>
          <ul>
            <li><a href="#缓存都做了什么">缓存都做了什么</a></li>
            <li><a href="#在聚簇索引中定位一条记录">在聚簇索引中定位一条记录</a>
              <ul>
                <li><a href="#通过索引页定位数据页">通过索引页定位数据页</a></li>
                <li><a href="#在数据页中定位目标记录">在数据页中定位目标记录</a></li>
              </ul>
            </li>
            <li><a href="#在二级索引中定位一条记录">在二级索引中定位一条记录</a></li>
            <li><a href="#锁和事务">锁和事务</a>
              <ul>
                <li><a href="#事务中不加锁的读">事务中不加锁的读</a></li>
                <li><a href="#事务中加锁的读">事务中加锁的读</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#插入记录的过程">插入记录的过程</a>
          <ul>
            <li><a href="#row_id的赋值步骤">row_id的赋值步骤</a></li>
            <li><a href="#自增列的数据生成">自增列的数据生成</a></li>
            <li><a href="#确定插入位置">确定插入位置</a></li>
            <li><a href="#申请空间">申请空间</a></li>
            <li><a href="#申请页">申请页</a></li>
            <li><a href="#锁与事务">锁与事务</a>
              <ul>
                <li><a href="#插入意向锁">插入意向锁</a></li>
                <li><a href="#隐式锁">隐式锁</a></li>
                <li><a href="#undo-log">undo log</a></li>
              </ul>
            </li>
            <li><a href="#二级索引">二级索引</a></li>
          </ul>
        </li>
        <li><a href="#删除记录的过程">删除记录的过程</a>
          <ul>
            <li><a href="#找到记录位置">找到记录位置</a></li>
            <li><a href="#删除记录">删除记录</a></li>
          </ul>
        </li>
        <li><a href="#更新记录的过程">更新记录的过程</a>
          <ul>
            <li><a href="#找到记录位置-1">找到记录位置</a></li>
            <li><a href="#更细记录">更细记录</a>
              <ul>
                <li><a href="#更新主键">更新主键</a></li>
                <li><a href="#不更新主键">不更新主键</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

          </div>
        </div>
      
      <div class="min-w-0 min-h-0 max-w-prose grow">
        <p>一直对MySQL这个黑盒子是如何运行的不甚清楚，因此在这里总结下。</p>
<p>先来了解下MySQL体系架构。</p>
<h1 id="mysql体系架构" class="relative group">MySQL体系架构 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#mysql%e4%bd%93%e7%b3%bb%e6%9e%b6%e6%9e%84" aria-label="Anchor">#</a></span></h1>
<p>



  <figure>
    <img class="mx-auto my-0 rounded-md" src="https://raw.githubusercontent.com/stong1994/images/master/picgo/20211006171205.jfif" alt="" />
    
  </figure>

</p>
<p><em>图片来自: <a
  href="https://segmentfault.com/a/1190000039693313"
  
  target="_blank" rel="noreferrer noopener"
>https://segmentfault.com/a/1190000039693313</a></em></p>
<p>以上图为对照，MySQL的查询会经历大致以下过程：</p>
<ol>
<li>客户端与服务端建立连接</li>
<li>查询缓存</li>
<li>将请求的SQL进行解析，并进行语法校验</li>
<li>通过优化器来优化SQL，生成执行计划</li>
<li>选择对应的存储引擎来执行计划，获取数据</li>
<li>向客户端返回查询结果</li>
</ol>
<p>那么我们就来分别看看这几步都做了哪些事情。</p>
<h1 id="建立连接" class="relative group">建立连接 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e5%bb%ba%e7%ab%8b%e8%bf%9e%e6%8e%a5" aria-label="Anchor">#</a></span></h1>
<p>客户端与服务端的连接本质上是进程间的通信，进程之间的通信方式有：管道、命名管道、命名字、TCP/IP套接字、UNIX域套接字。我们只讨论最常见的TCP/IP套接字。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mysql -h 127.0.0.1 -u root -p
</span></span></code></pre></div><p>连接时会查询<code>mysql.user</code>表进行权限校验。</p>
<blockquote>
<p>MySQL的通信协议是半双工的——在任意时刻，要么客户端向服务端发送数据，要么服务端向客户端发送数据。</p>
</blockquote>
<h1 id="查询缓存" class="relative group">查询缓存 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%9f%a5%e8%af%a2%e7%bc%93%e5%ad%98" aria-label="Anchor">#</a></span></h1>
<p>如果操作为查询，并且MySQL服务器开启了查询缓存，那么MySQL服务器会对sql进行缓存命中。</p>
<p>这个缓存是由大小写敏感的哈希查找实现的，对sql的任何改动都会导致不能命中缓存。</p>
<h1 id="解析sql" class="relative group">解析sql <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e8%a7%a3%e6%9e%90sql" aria-label="Anchor">#</a></span></h1>
<p>在这一步会校验sql是否符合语法，并将sql解析为token。</p>
<h1 id="查询优化" class="relative group">查询优化 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%9f%a5%e8%af%a2%e4%bc%98%e5%8c%96" aria-label="Anchor">#</a></span></h1>
<p>MySQL使用基于成本的优化器。成本分为IO成本和CPU成本，MySQL会定义每种操作对应的代价。大致流程为：</p>
<ol>
<li>根据搜索条件，找出所有可能使用的索引</li>
<li>计算全表扫描的代价</li>
<li>计算使用不同索引执行查询的代价</li>
<li>对比各种方案，选择成本最低的那个</li>
</ol>
<h1 id="执行语句" class="relative group">执行语句 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%89%a7%e8%a1%8c%e8%af%ad%e5%8f%a5" aria-label="Anchor">#</a></span></h1>
<p>只讨论增删改查。</p>
<h2 id="读取记录的过程" class="relative group">读取记录的过程 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e8%af%bb%e5%8f%96%e8%ae%b0%e5%bd%95%e7%9a%84%e8%bf%87%e7%a8%8b" aria-label="Anchor">#</a></span></h2>
<h3 id="缓存都做了什么" class="relative group">缓存都做了什么 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e7%bc%93%e5%ad%98%e9%83%bd%e5%81%9a%e4%ba%86%e4%bb%80%e4%b9%88" aria-label="Anchor">#</a></span></h3>
<p>InnoDB是以页为单位进行磁盘IO的，如果每次读取都要从磁盘读取，那么性能会很差。因此引入了缓存池——<code>BufferPool</code>，而从磁盘中加载到缓冲池中的页我们称为<strong>缓冲页</strong>。</p>
<p>每次读取数据页时，都从一个<strong>哈希表</strong>（key为表空间号+页号，value为控制块）中<strong>定位</strong>到<strong>缓冲页对应的控制块</strong>，如果不存在，则从磁盘进行读取，如果存在，则直接读取缓存。</p>
<p>每次从磁盘读取数据页时，都会在<code>Buffer Pool</code>中的<strong>free链表</strong>中获取空闲页，并<strong>填充缓冲页对应的控制块</strong>（我们需要这个结构来快速定位到目标缓冲页）。</p>
<p>InnoDB还引入了LRU链表来淘汰最近最少使用的缓冲页（参考<a
  href=""
  
  
>InnoDB中的LRU链表</a>）。</p>
<h3 id="在聚簇索引中定位一条记录" class="relative group">在聚簇索引中定位一条记录 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e5%9c%a8%e8%81%9a%e7%b0%87%e7%b4%a2%e5%bc%95%e4%b8%ad%e5%ae%9a%e4%bd%8d%e4%b8%80%e6%9d%a1%e8%ae%b0%e5%bd%95" aria-label="Anchor">#</a></span></h3>
<h4 id="通过索引页定位数据页" class="relative group">通过索引页定位数据页 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e9%80%9a%e8%bf%87%e7%b4%a2%e5%bc%95%e9%a1%b5%e5%ae%9a%e4%bd%8d%e6%95%b0%e6%8d%ae%e9%a1%b5" aria-label="Anchor">#</a></span></h4>
<ol>
<li>在<strong>索引页</strong>中，通过<strong>二分法</strong>定位记录所在的<strong>槽</strong>，这个槽对应着索引所在的<strong>索引记录组</strong>。（索引记录被分成多组，每组的最小值存入Page Directory，称为槽slot）</li>
<li>在<strong>索引记录组</strong>中通过<code>next_record</code>字段来<strong>遍历</strong>整个组，找到记录所在的索引页数据（主键+页号）</li>
<li>通过<strong>页号</strong>找到<strong>下一层树</strong>的<strong>目标索引页</strong></li>
<li>重复上述3个步骤，直到找到最后一层树——即数据页</li>
</ol>
<h4 id="在数据页中定位目标记录" class="relative group">在数据页中定位目标记录 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e5%9c%a8%e6%95%b0%e6%8d%ae%e9%a1%b5%e4%b8%ad%e5%ae%9a%e4%bd%8d%e7%9b%ae%e6%a0%87%e8%ae%b0%e5%bd%95" aria-label="Anchor">#</a></span></h4>
<ol>
<li>在<strong>数据页</strong>中找到<code>Page Directory</code>，通过<strong>二分法</strong>定位目标记录所在的<strong>槽</strong>（记录被分成多组，每组的最大值（<em>思考为什么是最大值而不是最小值</em>）存入Page Directory，称为槽slot）</li>
<li>通过<code>Page Directory</code>找到<strong>上一个槽</strong>，其对应的记录为该组的最大值，然后通过<code>next_record</code>来找到<strong>目的槽中的最小值</strong>，接着通过<code>next_record</code>来<strong>遍历整个目的组</strong>找到目标记录。</li>
</ol>
<h3 id="在二级索引中定位一条记录" class="relative group">在二级索引中定位一条记录 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e5%9c%a8%e4%ba%8c%e7%ba%a7%e7%b4%a2%e5%bc%95%e4%b8%ad%e5%ae%9a%e4%bd%8d%e4%b8%80%e6%9d%a1%e8%ae%b0%e5%bd%95" aria-label="Anchor">#</a></span></h3>
<p>定位方式同聚簇索引相同，不同之处在于<strong>二级索引中的数据页存储的是主键而不是完整的记录</strong>，因此需要通过主键进行<strong>回表</strong>查询。</p>
<h3 id="锁和事务" class="relative group">锁和事务 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e9%94%81%e5%92%8c%e4%ba%8b%e5%8a%a1" aria-label="Anchor">#</a></span></h3>
<h4 id="事务中不加锁的读" class="relative group">事务中不加锁的读 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e4%ba%8b%e5%8a%a1%e4%b8%ad%e4%b8%8d%e5%8a%a0%e9%94%81%e7%9a%84%e8%af%bb" aria-label="Anchor">#</a></span></h4>
<p>在事务中，如果读操作没有加锁，那么会生成一个ReadView来保证每次读到事务开始前已提交的数据（可重复读的隔离级别下每个事务中的多次读取复用同一个ReadView，读已提交的隔离界别下每次读取都会生成一个新的ReadView）</p>
<h4 id="事务中加锁的读" class="relative group">事务中加锁的读 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e4%ba%8b%e5%8a%a1%e4%b8%ad%e5%8a%a0%e9%94%81%e7%9a%84%e8%af%bb" aria-label="Anchor">#</a></span></h4>
<p>对读加锁有两种方式：</p>
<ul>
<li><code>SELECT .. LOCK IN SHARE MODE; </code>: 这是一个S锁</li>
<li><code>SELECT ... FOR UPDATE;</code>: 这是一个X锁</li>
</ul>
<p>通过对读操作加锁，从而阻止其他事务对目的记录进行修改（在有些场景，我们不允许其他事务对我们正在读取的记录进行修改）。</p>
<p>进行加锁操作也能使在可重复读级别下完全避免幻读（参考<a
  href=""
  
  
>MVCC产生幻读的特殊情况</a>）。</p>
<h2 id="插入记录的过程" class="relative group">插入记录的过程 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%8f%92%e5%85%a5%e8%ae%b0%e5%bd%95%e7%9a%84%e8%bf%87%e7%a8%8b" aria-label="Anchor">#</a></span></h2>
<p>如果创建表时没有定义主键且没有建立NOT NULL的唯一的索引键，那么InnoDB会创建一个隐式列row_id作为主键。因此需要对每一条记录生成一个row_id。</p>
<h3 id="row_id的赋值步骤" class="relative group">row_id的赋值步骤 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#row_id%e7%9a%84%e8%b5%8b%e5%80%bc%e6%ad%a5%e9%aa%a4" aria-label="Anchor">#</a></span></h3>
<ol>
<li>服务器在内存中维护一个全局变量，每当向包含row_id的表中插入一条记录时，获取这个变量作为row_id的值，并把这个全局变量自增1</li>
<li>每当全局变量的值变为256的倍数时，就会将该变量写入系统表空间中</li>
<li>当系统启动时，将系统表空间中的该变量加上256加载到内存中（加256是为了确保内存中的值一定比记录中已存在的row_id值大）</li>
</ol>
<h3 id="自增列的数据生成" class="relative group">自增列的数据生成 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e8%87%aa%e5%a2%9e%e5%88%97%e7%9a%84%e6%95%b0%e6%8d%ae%e7%94%9f%e6%88%90" aria-label="Anchor">#</a></span></h3>
<p>自增数据的生成需要用到锁，有两种情况：</p>
<ol>
<li>自增锁：这是一个表级别的锁，生成数据时，需要先获取锁，语句执行后再释放</li>
<li>轻量级锁：生成数据时进行获取锁，生成数据完成后即释放，不用等待语句执行</li>
</ol>
<h3 id="确定插入位置" class="relative group">确定插入位置 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e7%a1%ae%e5%ae%9a%e6%8f%92%e5%85%a5%e4%bd%8d%e7%bd%ae" aria-label="Anchor">#</a></span></h3>
<ol>
<li>
<p>通过聚簇索引的目录项找到数据页</p>
</li>
<li>
<p>再通过数据页的页目录找到数据应存储的槽</p>
<ol>
<li>如果槽对应的记录组的记录数量小于8个，那么直接插入到这个记录组中</li>
<li>如果槽对应的记录组的记录数量为8个，那么就需要将这个组分成两个组，存储主键较小的组中存放5条数据，同时在页目录中新增一个槽</li>
</ol>
</li>
</ol>
<h3 id="申请空间" class="relative group">申请空间 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e7%94%b3%e8%af%b7%e7%a9%ba%e9%97%b4" aria-label="Anchor">#</a></span></h3>
<p>确定插入位置后，需要申请空间进行存储记录。</p>
<ol>
<li>
<p>如果数据页中有足够的空闲空间，那么直接使用剩余的空间即可。</p>
</li>
<li>
<p>如果数据页中没有足够的空闲空间，且新记录主键的值大于已有的记录，那么就申请一个新的页来存储。</p>
</li>
<li>
<p>如果数据页中没有足够的空闲空间，且新记录主键不是最大值，那就去垃圾链表中找到第一个记录，看所占空间是否足够存储新记录</p>
<ol>
<li>
<p>如果足够，那么就将这个部分空间给到新记录，将多余的空间增加到PAGE HEADER中的可重用空间大小属性（PAGE_GARBAGE）。</p>
</li>
<li>
<p>如果垃圾链表中首个记录的空间不足以存储新记录，那么就查看整个页的可重用空间加上空闲空间是否足够存储新记录。</p>
<ol>
<li>如果足够，那么就重新组织页面——将用户记录写入到一个临时页，然后再将临时页的数据写会到数据页</li>
<li>如果不够，那么就申请一个新的页，并进行页分裂</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="申请页" class="relative group">申请页 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e7%94%b3%e8%af%b7%e9%a1%b5" aria-label="Anchor">#</a></span></h3>
<ol>
<li>
<p>数据页所在的段如果已包含32个碎片区，那么直接申请一个完整的区，并在区中申请一个页空间。</p>
</li>
<li>
<p>数据页所在的段如果未包含32个碎片区，那么从碎片区中申请一个空闲页。</p>
<ol>
<li>如果表空间中存在有空闲页的碎片区，那么直接在这个碎片区申请一个空闲页</li>
<li>如果表空间中的碎片区不包含空闲页，那么在表空间中先申请一个碎片区，然后再申请一个空闲页</li>
</ol>
</li>
</ol>
<h3 id="锁与事务" class="relative group">锁与事务 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e9%94%81%e4%b8%8e%e4%ba%8b%e5%8a%a1" aria-label="Anchor">#</a></span></h3>
<h4 id="插入意向锁" class="relative group">插入意向锁 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%8f%92%e5%85%a5%e6%84%8f%e5%90%91%e9%94%81" aria-label="Anchor">#</a></span></h4>
<p>如果新记录插入的<strong>间隙被其他事务加了gap锁</strong>，那么插入操作会<strong>阻塞</strong>，并且当前事务在间隙上增加一个<strong>插入意向锁</strong>。插入意向锁能够加速并发插入——<strong>插入意向锁之间并不互斥，对一个间隙内的多条记录，可以同时插入</strong>。</p>
<p>插入意向锁example：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="err">终端</span><span class="mi">1</span><span class="err">：</span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">begin</span><span class="p">;</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">update</span><span class="p">;</span><span class="c1">#对id小于8的记录加gap锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">终端</span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">begin</span><span class="p">;</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="k">user</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;6&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1"># 此时生成插入意向锁，并进入等待
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">终端</span><span class="mi">3</span><span class="p">:</span><span class="w"> </span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">begin</span><span class="p">;</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="k">user</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;7&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1"># 此时生成插入意向锁，并进入等待
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">终端</span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">commit</span><span class="p">;</span><span class="w"> </span><span class="c1"># 此时终端2和3同时获取到锁，并执行语句。
</span></span></span></code></pre></div><h4 id="隐式锁" class="relative group">隐式锁 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e9%9a%90%e5%bc%8f%e9%94%81" aria-label="Anchor">#</a></span></h4>
<p>新插入的数据受<strong>隐式锁</strong>保护：当事务在读取一条新插入的记录时，会根据这条记录的事务id来判断是否能够读取。如果<strong>事务id大于Read View中的最大事务id，那么就不能读取</strong>，如果<strong>事务id是Read View中的活跃事务id，那么不能立即读取，需要帮助这条记录创建一个X锁结构，然后再为自己创建一个S锁结构，标识为等待</strong>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="err">终端</span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">begin</span><span class="p">;</span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="k">user</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;6&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1"># 此时新记录未提交
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">终端</span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">begin</span><span class="p">;</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="k">LOCK</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">SHARE</span><span class="w"> </span><span class="n">MODE</span><span class="p">;</span><span class="w"> </span><span class="c1"># 此时为id=6生成X锁，未自身生成S锁，并等待(如果没有加S锁，则不会等待)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">终端</span><span class="mi">3</span><span class="p">:</span><span class="w"> </span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">begin</span><span class="p">;</span><span class="k">update</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="kt">set</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;7&#39;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="c1"># 此时未获得锁，等待
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">终端</span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">commit</span><span class="p">;</span><span class="w"> </span><span class="c1"># 此时终端2获取到锁，并执行查询语句，能够查询到id=6的记录。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">终端</span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">commit</span><span class="p">;</span><span class="w"> </span><span class="c1"># 此时终端3获取到锁，并执行update语句，能够正常更新。
</span></span></span></code></pre></div><h4 id="undo-log" class="relative group">undo log <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#undo-log" aria-label="Anchor">#</a></span></h4>
<p>向undo log中加入一条记录，主要记录事务id、主键信息等，用于执行回滚。</p>
<h3 id="二级索引" class="relative group">二级索引 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e4%ba%8c%e7%ba%a7%e7%b4%a2%e5%bc%95" aria-label="Anchor">#</a></span></h3>
<p>二级索引记录的插入和聚簇索引相似，但二级索引记录中没有事务id，每次对页进行更新时，需要把Page Header中的最大事务ID进行更新。</p>
<h2 id="删除记录的过程" class="relative group">删除记录的过程 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e5%88%a0%e9%99%a4%e8%ae%b0%e5%bd%95%e7%9a%84%e8%bf%87%e7%a8%8b" aria-label="Anchor">#</a></span></h2>
<h3 id="找到记录位置" class="relative group">找到记录位置 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%89%be%e5%88%b0%e8%ae%b0%e5%bd%95%e4%bd%8d%e7%bd%ae" aria-label="Anchor">#</a></span></h3>
<p>其方式和“插入数据的过程”中的“找到插入位置”相同。</p>
<h3 id="删除记录" class="relative group">删除记录 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e5%88%a0%e9%99%a4%e8%ae%b0%e5%bd%95" aria-label="Anchor">#</a></span></h3>
<p>找到记录后，其删除步骤分两部分：</p>
<ol>
<li><strong>标记为删除</strong>：每行记录都有一个删除标志位，用于标识记录是否已删除（为了其他事务还能读取到，因此不能立即删除）。并生成对应的undo log</li>
<li>将记录从正常记录链中移除，并<strong>加入到垃圾链表</strong>中，同时更新页的可重用空间、页目录等信息（purge阶段执行）</li>
</ol>
<p>对于二级索引，根据聚簇索引对二级索引进行更新即可。</p>
<h2 id="更新记录的过程" class="relative group">更新记录的过程 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%9b%b4%e6%96%b0%e8%ae%b0%e5%bd%95%e7%9a%84%e8%bf%87%e7%a8%8b" aria-label="Anchor">#</a></span></h2>
<h3 id="找到记录位置-1" class="relative group">找到记录位置 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%89%be%e5%88%b0%e8%ae%b0%e5%bd%95%e4%bd%8d%e7%bd%ae-1" aria-label="Anchor">#</a></span></h3>
<p>其方式和“插入数据的过程”中的“找到插入位置”相同。</p>
<h3 id="更细记录" class="relative group">更细记录 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%9b%b4%e7%bb%86%e8%ae%b0%e5%bd%95" aria-label="Anchor">#</a></span></h3>
<h4 id="更新主键" class="relative group">更新主键 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e6%9b%b4%e6%96%b0%e4%b8%bb%e9%94%ae" aria-label="Anchor">#</a></span></h4>
<p>如果需要更新主键，那么其操作为删除操作+插入操作</p>
<ol>
<li>将旧记录标记为删除（不将其立即加入垃圾链表，因为别的事务还可能用到，后续在purge阶段处理）</li>
<li>对新记录执行插入操作</li>
</ol>
<p>同时生成两个undo log。</p>
<h4 id="不更新主键" class="relative group">不更新主键 <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%e4%b8%8d%e6%9b%b4%e6%96%b0%e4%b8%bb%e9%94%ae" aria-label="Anchor">#</a></span></h4>
<ol>
<li>如果新旧记录的各列长度均相同，那么直接进行原地更新，并生成undo log</li>
<li>如果至少有一列的新旧数据长度不同，那么
<ol>
<li>将记录立即加入到垃圾链表中</li>
<li>如果旧记录长度大于新记录，那么新记录可以复用旧记录的空间，否则申请新空间</li>
</ol>
</li>
</ol>

      </div>
    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      
  <div class="flex">
    
      
      
        
        <img
          class="!mb-0 !mt-0 me-4 h-24 w-24 rounded-full"
          width="96"
          height="96"
          alt="stong"
          src="/imgs/mine_hu9cc37546ab3d9fb1d864cca548ef6007_144068_192x192_fill_q75_box_center.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
          Author
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          stong
        </div>
      
      
        <div class="text-sm text-neutral-700 dark:text-neutral-400">进击的程序员</div>
      
      <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
          style="will-change:transform;"
          href="st5983@outlook.com"
          target="_blank"
          aria-label="Email"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
          style="will-change:transform;"
          href="https://stong1994.github.io/"
          target="_blank"
          aria-label="Link"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400"
          style="will-change:transform;"
          href="https://github.com/stong1994"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</a
        >
      
    
  </div>

</div>
    </div>
  </div>


      

      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="group flex" href="/internet/mysql/InnoDB_struct/">
              <span
                class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                ><span class="ltr:inline rtl:hidden">&larr;</span
                ><span class="ltr:hidden rtl:inline">&rarr;</span></span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >InnoDB存储引擎的物理结构</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-01-03 13:32:00 &#43;0800 CST">3 January 2022</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="group flex text-right" href="/internet/mysql/acid/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >理解事务：InnoDB的ACID</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2022-01-16 17:05:00 &#43;0800 CST">16 January 2022</time>
                  
                </span>
              </span>
              <span
                class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                ><span class="ltr:inline rtl:hidden">&rarr;</span
                ><span class="ltr:hidden rtl:inline">&larr;</span></span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        
          <div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12">
            <a
              href="#the-top"
              class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
              aria-label="Scroll to top"
              title="Scroll to top"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <div class="flex items-center justify-between">
    <div>
      
      
        <p class="text-sm text-neutral-500 dark:text-neutral-400">
            &copy;
            2023
            stong
        </p>
      
      
      
        <p class="text-xs text-neutral-500 dark:text-neutral-400">
          
          
          Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
            href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://git.io/hugo-congo" target="_blank" rel="noopener noreferrer">Congo</a>
        </p>
      
    </div>
    
    
      <div
        class="me-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
      >
        <button id="appearance-switcher-0" type="button" aria-label="appearance switcher">
          <div
            class="flex h-12 w-12 items-center justify-center dark:hidden"
            title="Switch to dark appearance"
          >
            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


          </div>
          <div
            class="hidden h-12 w-12 items-center justify-center dark:flex"
            title="Switch to light appearance"
          >
            

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


          </div>
        </button>
      </div>
    
  </div>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url=""
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
</html>
